<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>è·¨æœŸå†³ç­–é‡è¡¨æ³•æ¨¡æ¿</title>
        <link href="css/jspsych.css" rel="stylesheet" type="text/css" />
        <link href="css/style.css" rel="stylesheet" type="text/css" />
        <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />

        <script src="js/jspsych.js"></script>
        <script src="js/plugin-html-button-response.js"></script>
        <script src="js/plugin-call-function.js"></script>
        <script src="js/plugin-instructions.js"></script>
    </head>

    <body></body>

    <script>
        const timeline = [];

        /* 
            å‚¨å­˜æ–‡ä»¶æ ¼å¼å’Œå‘½åæ•°æ®æ–‡ä»¶
            æ¯åšå®Œä¸€ä¸ªè¢«è¯•æµè§ˆå™¨éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªä»¥æ—¶é—´å‘½åçš„æ•°æ®æ–‡ä»¶
            å› ä¸ºæ¯ä¸ªäººçš„æ•°æ®å‘½åæ˜¯ä¸åŒçš„ï¼Œå¦‚æœç›¸åŒåˆ™æœ‰å¯èƒ½å‡ºç°è¦†ç›–ï¼Œ
            æ‰€ä»¥ä»¥ç­”é¢˜æ—¶é—´ä¸ºå‘½åæ˜¯å”¯ä¸€çš„ 
        */
        const nowdate = new Date(),
        month = nowdate.getMonth(),
        date = nowdate.getDate(),
        hour = nowdate.getHours(),
        minutes = nowdate.getMinutes()

        const file_name = month+'_'+date+'_'+hour+'_'+minutes

        const jsPsych = initJsPsych({
            on_finish: function() {
                jsPsych.data.get().localSave('csv',`${file_name}.csv`);
            }
          }
        );

        /* 
          å®éªŒçš„åŸºç¡€è®¾ç½®ï¼Œè¿™éƒ¨åˆ†ç›´æ¥å¤åˆ¶å³å¯ï¼Œå¤åˆ¶å®Œè®°å¾—åœ¨headæ ‡ç­¾é‡Œå¼•ç”¨call-functionæ’ä»¶
        */
        var set_style = {
            type: jsPsychCallFunction,
            func: function () {
                document.body.style.backgroundColor = 'black' // background color
                document.body.style.color = 'white' // font color
                document.body.style.fontFamily = 'å¾®è½¯é›…é»‘'
                document.body.style.cursor = 'default' // 'default', 'none', 'wait', ...
                document.body.onselectstart = function () { return false } // ç¦æ­¢é€‰ä¸­æ–‡å­— <body oncontextmenu="return false">
                document.body.oncontextmenu = function () { return false } // ç¦ç”¨é¼ æ ‡å³é”® <body onselectstart="return false">
                document.onkeydown = function () {
                    // å±è”½é”®ç›˜æŒ‰é”® (https://www.bejson.com/othertools/keycodes/)
                    if ((event.keyCode in { 27: 'Esc', 116: 'F5', 123: 'F12' }) ||
                        (event.ctrlKey && event.keyCode in { 85: 'U' })
                    ) {
                        return false
                    }
                }
            },
        }
        timeline.push(set_style)

        /*
            æŒ‡å¯¼è¯­éƒ¨åˆ†
            å¯ä»¥å°†é‡Œé¢çš„ä¸­æ–‡éšæ„æ›´æ”¹ä¸ºä½ æ‰€éœ€è¦çš„æŒ‡å¯¼è¯­
            å¦‚æœä½ çš„æŒ‡å¯¼è¯­è¿‡é•¿ä¼šè‡ªåŠ¨æ¢è¡Œ
            ä½†æ˜¯å¦‚æœä½ è®¤ä¸ºæ¢è¡Œçš„ä½ç½®ä¸å¥½çœ‹
            é‚£ä¹ˆè¯·åœ¨ä½ éœ€è¦æ¢è¡Œçš„åœ°æ–¹æ’å…¥ä¸€ä¸ª <br/> æ ‡ç­¾å³å¯
        */ 
        var instructions = {
            type: jsPsychInstructions,
            pages: [
                `<div class='instruction' style='color:white'>
                        è¯·ä½ æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å°†è·å¾—ä¸€ç¬”é’±ï¼Œä½ éœ€è¦åœ¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œä½ ä¼šé€‰æ‹©å“ªç§æ–¹å¼ï¼Ÿ
                    </div>
                    <div class='option'>
                        <p>Aï¼šç°åœ¨è·å¾—ä¸€ç¬”æ•°é¢è¾ƒå°çš„é’±</p>
                        <p>Bï¼šç­‰å¾…ä¸€æ®µæ—¶é—´åè·å¾—ä¸€ç¬”æ•°é¢è¾ƒå¤§çš„é’±</p>
                </div>
                <div class='ready'><å¦‚æœç†è§£äº†ä¸Šè¿°æŒ‡å¯¼è¯­ï¼Œè¯·ç‚¹å‡»ğŸ‘‡></div>`
            ],
            show_clickable_nav: true,
            allow_backward: false,
            button_label_next: 'å¼€å§‹',
            allow_keys: false,
        };
        timeline.push(instructions)

        /*
            ä¸»ç¨‹åº
            ä»¥ä¸‹å†…å®¹è¯·å‹¿æ”¹åŠ¨ï¼Œè¯·æ•´ä½“å¤åˆ¶ç²˜è´´ä½¿ç”¨ï¼Œåˆ«å¿˜äº†headé‡Œçš„jså’Œcsså†…å®¹
        */
        var normal_trails = {
            timeline: [{
                type: jsPsychHtmlButtonResponse,
                stimulus: `<div class='instruction' style='color:white'>ä½ ä¼šé€‰æ‹©ä»¥ä¸‹å“ªç§æ–¹å¼ï¼Ÿ</div>`,
                choices: [function () {
                        var html = 
                            `<div class='choice-describe'>
                                <span id='sooner' class='condition'></span> ç°åœ¨è·å¾—
                                <span class='items'> ${jsPsych.timelineVariable('SDR')}</span> å…ƒ
                            </div>`
                        return html;
                    },
                    function () {
                        var html =
                            `<div class='choice-describe'>
                                <span id='later' class='condition'> ${jsPsych.timelineVariable('day')}</span> å¤©åè·å¾—
                                <span class='items'> ${jsPsych.timelineVariable('LDR')}</span> å…ƒ
                            </div>`
                        return html
                    },
                ],
                button_html : `<button class="btn btn-light btn-lg">%choice%</button>`,
                data: {'order': jsPsych.timelineVariable('order')},
            }, ],
            timeline_variables: [
                {SDR: '54',LDR: '55',day: '117',order: "normal_1"},
                {SDR: '55',LDR: '75',day: '61',order: "normal_2"},
                {SDR: '19',LDR: '25',day: '53',order: "normal_3"},
                {SDR: '31',LDR: '85',day: '7',order: "normal_4"},
                {SDR: '14',LDR: '25',day: '19',order: "normal_5"},
                {SDR: '47',LDR: '50',day: '160',order: "normal_6"},
                {SDR: '15',LDR: '35',day: '13',order: "normal_7"},
                {SDR: '25',LDR: '60',day: '14',order: "normal_8"},
                {SDR: '78',LDR: '80',day: '162',order: "normal_9"},
                {SDR: '40',LDR: '55',day: '62',order: "normal_10"},
                {SDR: '11',LDR: '30',day: '7',order: "normal_11"},
                {SDR: '67',LDR: '75',day: '119',order: "normal_12"},
                {SDR: '34',LDR: '35',day: '186',order: "normal_13"},
                {SDR: '27',LDR: '50',day: '21',order: "normal_14"},
                {SDR: '69',LDR: '85',day: '91',order: "normal_15"},
                {SDR: '49',LDR: '60',day: '89',order: "normal_16"},
                {SDR: '80',LDR: '85',day: '157',order: "normal_17"},
                {SDR: '24',LDR: '35',day: '29',order: "normal_18"},
                {SDR: '33',LDR: '80',day: '14',order: "normal_19"},
                {SDR: '28',LDR: '30',day: '179',order: "normal_20"},
                {SDR: '34',LDR: '50',day: '30',order: "normal_21"},
                {SDR: '25',LDR: '30',day: '80',order: "normal_22"},
                {SDR: '41',LDR: '75',day: '20',order: "normal_23"},
                {SDR: '54',LDR: '60',day: '111',order: "normal_24"},
                {SDR: '54',LDR: '80',day: '30',order: "normal_25"},
                {SDR: '22',LDR: '25',day: '136',order: "normal_26"},
                {SDR: '20',LDR: '55',day: '7',order: "normal_27"},
            ],
            post_trial_gap: 400,
        };
        timeline.push(normal_trails)

        jsPsych.run(timeline)
    </script>
</html>