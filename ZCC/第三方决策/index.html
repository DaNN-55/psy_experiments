<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>ç¬¬ä¸‰æ–¹å†³ç­–</title>
        <link href="css/jspsych.css" rel="stylesheet" type="text/css" />
        <link href="css/style.css" rel="stylesheet" type="text/css" />
        <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />

        <script src="js/jspsych.js"></script>
        <script src="js/plugin-browser-check.js"></script>
        <script src="js/plugin-call-function.js"></script>
        <script src="js/plugin-instructions.js"></script>
        <script src="js/plugin-fullscreen.js"></script>
        <script src="js/plugin-html-keyboard-response.js"></script>
        <script src="js/plugin-html-button-response.js"></script>
        <script src="js/plugin-survey-html-form.js"></script>
        <script src="js/plugin-survey.js"></script>
        <script src="js/plugin-survey-multi-choice.js"></script>
    </head>

    <body></body>

    <script>
        const nowdate = new Date(),
            month = nowdate.getMonth(),
            date = nowdate.getDate(),
            hour = nowdate.getHours(),
            minutes = nowdate.getMinutes()

        const file_name = month + 1 + '_' + date + '_' + hour + '_' + minutes

        const jsPsych = initJsPsych({
            on_finish: function () {
                jsPsych.data.get().localSave('json', `${file_name}.json`);
            }
        });


        var brower = {
            type: jsPsychBrowserCheck,
            minimum_width: 1000,
            minimum_height: 600,
            window_resize_message:'ä½ çš„æµè§ˆå™¨çª—å£è¿‡å°ï¼Œè¯·ä½¿ç”¨ç”µè„‘ä½œç­”ï¼Œæ„Ÿè°¢é…åˆã€‚<br/>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å³å¯ç»“æŸå®éªŒã€‚',
            resize_fail_button_text: 'ç»“æŸå®éªŒ',
            exclusion_message: () => { return 'ä½ çš„æ˜¾ç¤ºçª—å£è¿‡å°ï¼Œè¯·è°ƒå¤§æ˜¾ç¤ºçª—å£æˆ–è€…åˆ‡æ¢ç”µè„‘ä½œç­”ã€‚' }
        };

        var enter_fullscreen = {
            type: jsPsychFullscreen,
            message: `
                <p style="font: 16pt å¾®è½¯é›…é»‘; text-align: left; line-height: 1.6em">
                <b>
                æµ‹éªŒå°†åœ¨ä¸€ä¸ªã€Œå…¨å±é¡µé¢ã€å¼€å§‹ï¼Œä¸ºç¡®ä¿æœ€ä½³æ•ˆæœï¼Œè¯·ä½ ï¼š<br/>
                ï¼ˆ1ï¼‰åœ¨ç”µè„‘ä¸Šè¿›è¡Œæµ‹éªŒï¼Œå¹¶ä½¿ç”¨ä¸»æµæµè§ˆå™¨æ‰“å¼€æœ¬ç½‘é¡µ<br/>
                &emsp;&emsp;ï¼ˆChromeã€Edgeã€Firefoxã€Safariç­‰ï¼Œä¸è¦ç”¨IEï¼‰<br/>
                ï¼ˆ2ï¼‰å…³æ‰ç”µè„‘ä¸Šå…¶ä»–æ­£åœ¨è¿è¡Œçš„ç¨‹åºæˆ–å°†å…¶æœ€å°åŒ–<br/>
                ï¼ˆ3ï¼‰å°†æ‰‹æœºè°ƒè‡³é™éŸ³ï¼Œå¹¶å°½å¯èƒ½å‡å°‘ç¯å¢ƒå™ªéŸ³å¹²æ‰°<br/>
                ï¼ˆ4ï¼‰åœ¨æµ‹éªŒè¿‡ç¨‹ä¸­ä¸è¦é€€å‡ºå…¨å±<br/>
                ï¼ˆ5ï¼‰åŠ¡å¿…è®¤çœŸä½œç­”<br/><br/>
                </b>
                å¦‚æœä½ åŒæ„å‚ä¸ï¼Œå¹¶ä¸”æ¸…æ¥šç†è§£äº†ä¸Šè¿°è¦æ±‚ï¼Œè¯·ç‚¹å‡»å¼€å§‹ï¼š
                </p>`,
            button_label:'ç‚¹å‡»è¿™é‡Œå…¨å±å¼€å§‹',
            fullscreen_mode: true,
            delay_after: 100
        }

        var set_style = {
            type: jsPsychCallFunction,
            func: function () {
                document.body.style.backgroundColor = 'black' // background color
                document.body.style.color = 'white' // font color
                document.body.style.fontFamily = 'å¾®è½¯é›…é»‘'
                document.body.style.cursor = 'default' // 'default', 'none', 'wait', ...
                document.body.onselectstart = function () { return false } // ç¦æ­¢é€‰ä¸­æ–‡å­— <body oncontextmenu="return false">
                document.body.oncontextmenu = function () { return false } // ç¦ç”¨é¼ æ ‡å³é”® <body onselectstart="return false">
                document.onkeydown = function () {
                    // å±è”½é”®ç›˜æŒ‰é”® (https://www.bejson.com/othertools/keycodes/)
                    if ((event.keyCode in { 27: 'Esc', 116: 'F5', 123: 'F12' }) ||
                        (event.ctrlKey && event.keyCode in { 85: 'U' })
                    ) {
                        return false
                    }
                }
            },
        }

        var info = {
            type: jsPsychSurveyHtmlForm,
            preamble: "",
            html: ` <p class='h2'>åŸºæœ¬ä¿¡æ¯</p>
                        <div class='row'>
                            <div class='col auto'>
                                <div class='input-group mb-2'>
                                    <span class='input-group-text'>å§“å</span>
                                    <input class='form-control' type='text' name='name' required/>
                                </div>
                            </div>

                            <div class='col auto'>
                                <div class='input-group mb-2'>
                                    <span class='input-group-text'>æ€§åˆ«</span>
                                    <select class='form-select' name='gender' required/>        
                                        <option value=''></option>
                                        <option value='1'>ç”·</option>
                                        <option value='0'>å¥³</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class='row'>
                            <div class='col'>
                                <div class='input-group mb-2'>
                                    <span class='input-group-text'>å¹´é¾„</span>
                                    <input class='form-control' type='number' name='age' required/>
                                </div>
                            </div>

                            <div class='col'>
                                <div class='input-group mb-2'>
                                    <span class='input-group-text'>å¹´çº§</span>
                                    <select class='form-select' name='grade' required/>        
                                        <option value=''></option>
                                        <option value='0'>æœ¬ç§‘ç”Ÿ</option>
                                        <option value='1'>ç ”ç©¶ç”Ÿ</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class='row'>
                            <div class='col'>
                                <div class='input-group mb-2'>
                                    <span class='input-group-text'>æ¥æºåœ°</span>
                                    <select class='form-select' name='home' required>
                                    <option value=''></option>
                                    <option value='0'>å†œæ‘æˆ·å£</option>
                                    <option value='1'>åŸé•‡æˆ·å£</option>
                                    </select>
                                </div>
                            </div>
                        </div>`,
            button_label: 'æäº¤',
            dataAsArray: true,
            autofocus: 'test-resp-box',
            data:{task:'info'},
        };

        var agreement = {
            type: jsPsychInstructions,
            pages: [
                `<div class='cover'>
                    <div class='cover-title'>
                        æ¬¢è¿å‚ä¸å®éªŒ
                    </div>
                    <div class='cover-text'>
                        <p>æœ¬å®éªŒå…±åŒ…å«å››ä¸ªéƒ¨åˆ†ï¼Œçº¦15-20åˆ†é’Ÿå®Œæˆã€‚å®éªŒç»“æŸåï¼Œæˆ‘ä»¬å°†æ ¹æ®æ‚¨çš„è®¤çœŸç¨‹åº¦ç»™äºˆè¢«è¯•è´¹ï¼Œè¯·åŠ¡å¿…è®¤çœŸä½œç­”ã€‚</p>
                        <p class='lighting'>ä½ å°†å‚åŠ ä¸€ä¸ªåˆ†é…å…±åŒåŠ³åŠ¨æŠ¥é…¬çš„æ¸¸æˆã€‚è¯¥æ¸¸æˆéœ€è¦å¯¹100å…ƒé’±è¿›è¡Œåˆ†é…ï¼Œæ¸¸æˆåŒ…æ‹¬3ä¸ªè§’è‰²ï¼šåˆ†é…è€…Aã€æ¥å—è€…Bã€æ—è§‚è€…Cã€‚</p>
                        <p>æˆ‘ä»¬æ‰¿è¯ºæ‰€æœ‰æ•°æ®ä»…ç”¨ä½œå­¦æœ¯ç ”ç©¶ï¼Œä¸ä¼šæ³„éœ²å…³äºæ‚¨çš„ä»»ä½•éšç§ï¼Œå› æ­¤ç­”é¢˜è¿‡ç¨‹ä¸­è¯·åŠ¡å¿…è®¤çœŸä½œç­”ã€‚</p>
                    </div>
                    <input class="form-check-input" type="checkbox" id='checkbox'>
                    <label class="form-check-label">
                        æˆ‘å·²ç†è§£ä¸Šè¿°å†…å®¹ï¼ŒåŒæ„å¼€å§‹è¯„æµ‹
                    </label>
                </div>`,
            ],
            show_clickable_nav: true,
            allow_backward: false,
            button_label_next: 'å¼€å§‹',
            allow_keys: false,
            on_load: function () {
                var submitBtn = document.getElementById('jspsych-instructions-next');
                submitBtn.disabled = true;
                var box = document.getElementById('checkbox');
                box.addEventListener("change", function(){
                    if (box.checked===true) {
                        submitBtn.disabled=false;
                    }else{
                        submitBtn.disabled=true;
                    }
                })
            }
        };

        var actor = {
            timeline: [
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: `<h2>è§’è‰²åˆ†é…ä¸­</h2><div class='spinner-border text-light m-5' role='status'><span class='visually-hidden'>loading</span></div> `,
                    choices: "NO_KEYS",
                    trial_duration: 1000,
                },
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus:`<h2>æ‚¨çš„è§’è‰²ä¸ºï¼š<span class='lighting'>æ—è§‚è€…C</span></h2>`,
                    trial_duration: 3000,
                    choices: "NO_KEYS",
                }

            ]

        }

        var exp1_instr = {
            type: jsPsychInstructions,
            pages: [
                `<div class='cover'>
                    <p class='h1'>å®éªŒä¸€</p>
                    <div class='cover-text'>
                       <p>
                            <span class='lighting'>Aå’ŒBåœ¨å…±åŒå®Œæˆä¸€é¡¹ä»»åŠ¡ã€ä»˜å‡ºåŒæ ·çš„åŠ³åŠ¨</span>åè·å¾—100å…ƒæŠ¥é…¬ï¼Œ
                            <span class='lighting'>åˆ†é…è€…Aè¿›è¡Œåˆ†é…</span>ï¼Œéœ€è¦å°†è¿™100å…ƒåˆ†é…ç»™è‡ªå·±å’Œæ¥å—è€…Bï¼Œ
                            <span class='lighting'>è€Œæ¥å—è€…Bæ— æƒæ‹’ç»</span>ï¼Œåªèƒ½æ¥å—ã€‚
                        </p>
                        <p>
                            <span class='lighting'>æ—è§‚è€…Cäº‹å…ˆæ‹¥æœ‰50å…ƒ</span>ï¼Œä¸å‚ä¸è¿™100å…ƒåˆ†é…ï¼Œ
                            ä½†æ˜¯Cå¯ä»¥åœ¨Aè¿›è¡Œåˆ†é…å<span class='lighting'>é€‰æ‹©æ˜¯å¦å¯¹åˆ†é…æ–¹æ¡ˆè¿›è¡Œè°ƒæ•´</span>ã€‚
                        </p>
                        <p>
                            è°ƒæ•´è§„åˆ™å¦‚ä¸‹ï¼šæ—è§‚è€…Cæœ‰æƒä»è‡ªå·±çš„50å…ƒé’±ä¸­
                            <span class='lighting'>æ‹¿å‡ºä¸€å®šçš„é’±æ•°Xå…ƒå»æ‰£é™¤åˆ†é…è€…Aé’±æ•°çš„3Xå…ƒ</span>ä½œä¸ºæƒ©ç½šã€‚
                        </p>
                    </div>
                    <p class='ready'>
                        <é˜…è¯»æ˜ç™½åè¯·ç‚¹å‡»å¼€å§‹ğŸ‘‡>
                    </p>
                </div>`,
            ],
            show_clickable_nav: true,
            allow_backward: false,
            button_label_next: 'å¼€å§‹',
            allow_keys: false,
        };

        var exp1 = {
            timeline: [
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: '<p style="font-size:60px;font-weight:bolder">+</p>',
                    choices: "NO_KEYS",
                    trial_duration: 1000
                },
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: function () {
                        var html = `<div class="container text-center">
                                <div class="row g-2">
                                    <div class="col-6">
                                    <div class="p-3">åˆ†é…è€…A</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">æ¥å—è€…B</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">${jsPsych.timelineVariable('a_money')}</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">${jsPsych.timelineVariable('b_money')}</div>
                                    </div>
                                </div>
                            </div>`
                        return html
                    },
                    data:{task:function () {
                        var html = `${jsPsych.timelineVariable('a_money')}:${jsPsych.timelineVariable('b_money')}`
                        return html
                        }
                    },
                    trial_duration: 2000,
                },
                {
                    type: jsPsychHtmlButtonResponse,
                    stimulus: `<p class='h2'>æ˜¯å¦é€‰æ‹©å‡å°‘Aé’±æ•°ï¼Ÿ</p>`,
                    choices: ['æ˜¯','å¦'],
                    button_html:'<button class="jspsych-btn" id="jspsych-btn-choice">%choice%</button>',
                    data:{task:'choice1'}
                },
            ],
        }

        var exp1_choice_trial = {
            timeline:[
                {
                    type: jsPsychHtmlButtonResponse,
                    stimulus: `<p class='h2'>cé€‰æ‹©æ‹¿å‡ºå¤šå°‘ï¼Ÿ</p>`,
                    choices: ['5','10','15','20','25','30','35'],
                    data:{task:'money'}
                },
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: function () {
                        var choice1 = jsPsych.data.get().last(1).values()[0].response;
                        var html = `
                            <div class='h1' style='text-align:left'>ç»“æœåé¦ˆ</div>
                            <p></p>
                            <div class="container text-center">
                                <div class="row g-3">
                                    <div class="col-4">
                                        <div class="p-3">åˆ†é…è€…A</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">æ¥å—è€…B</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">åˆ†é…è€…C</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('a_money')-3*(choice1+1)*5}</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('b_money')}</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('c_money')-(choice1+1)*5}</div>
                                    </div>
                                </div>
                            </div>`
                        return html
                    },
                    trial_duration: 1000
                }
            ]
        }

        var exp1_if = {
            timeline: [exp1_choice_trial],
            conditional_function: function(){
                var data = jsPsych.data.get().last(1).values()[0].response;
                if(data==1){
                    return false;
                } else {
                    return true;
                }
            }
        }

        var ready = {
            type: jsPsychInstructions,
            pages: [
                `<p class='h2'>æ¥ä¸‹æ¥ä¼šæœ‰ä¸¤ä¸ªé¢„å®éªŒè¯•æ¬¡ï¼Œå¦‚æœå‡†å¤‡å¥½äº†è¯·ç‚¹å‡»å¼€å§‹</p>`,
            ],
            show_clickable_nav: true,
            allow_backward: false,
            button_label_next: 'å¼€å§‹',
            allow_keys: false,
        }

        var ready_end = {
            type: jsPsychHtmlButtonResponse,
            stimulus: `<p class='h2'>ç»ƒä¹ ç»“æŸï¼</p>`,
            choices: ['ä¸ç”šæ˜æ™°ï¼ç»§ç»­ç»ƒä¹ ','ä¸€æ¸…äºŒæ¥šï¼Œè¿›å…¥å®éªŒ'],
            data:{task:'ready'}
        }

        var pre_main_exp1 = {
            timeline:[exp1,exp1_if],
            timeline_variables: [
                {a_money:65,b_money:35,c_money:50},
                {a_money:75,b_money:25,c_money:50},
            ],
            data:{task:'ready'}
        }

        var pre_exp1 = {
            timeline: [pre_main_exp1,ready_end],
            loop_function: function(data){
                if(jsPsych.data.get().last(1).values()[0].response==0){
                    return true;
                } else {
                    return false;
                }
            }
        }

        var main_exp1 = {
            timeline:[exp1,exp1_if],
            repetitions: 4,
            randomize_order: true,
            timeline_variables: [
                {a_money:100,b_money:0,c_money:50},
                {a_money:90,b_money:10,c_money:50},
                {a_money:80,b_money:20,c_money:50},
                {a_money:70,b_money:30,c_money:50},
                {a_money:60,b_money:40,c_money:50},
                {a_money:50,b_money:50,c_money:50},
            ],
        }

        var exp2_instr = {
            type: jsPsychInstructions,
            pages: [
                `<div class='cover'>
                    <p class='h1'>å®éªŒäºŒ</p>
                    <div class='cover-text'>
                       <p>
                            <span class='lighting'>Aå’ŒBåœ¨å…±åŒå®Œæˆä¸€é¡¹ä»»åŠ¡ã€ä»˜å‡ºåŒæ ·çš„åŠ³åŠ¨</span>åè·å¾—100å…ƒæŠ¥é…¬ï¼Œ
                            <span class='lighting'>åˆ†é…è€…Aè¿›è¡Œåˆ†é…</span>ï¼Œéœ€è¦å°†è¿™100å…ƒåˆ†é…ç»™è‡ªå·±å’Œæ¥å—è€…Bï¼Œ
                            <span class='lighting'>è€Œæ¥å—è€…Bæ— æƒæ‹’ç»</span>ï¼Œåªèƒ½æ¥å—ã€‚
                        </p>
                        <p>
                            <span class='lighting'>æ—è§‚è€…Cäº‹å…ˆæ‹¥æœ‰50å…ƒ</span>ï¼Œä¸å‚ä¸è¿™100å…ƒåˆ†é…ï¼Œ
                            ä½†æ˜¯Cå¯ä»¥åœ¨Aè¿›è¡Œåˆ†é…å<span class='lighting'>é€‰æ‹©æ˜¯å¦å¯¹åˆ†é…æ–¹æ¡ˆè¿›è¡Œè°ƒæ•´</span>ã€‚
                        </p>
                        <p>
                            è°ƒæ•´è§„åˆ™å¦‚ä¸‹ï¼šæ—è§‚è€…Cæœ‰æƒä»è‡ªå·±çš„50å…ƒé’±ä¸­
                            <span class='lighting'>æ‹¿å‡ºä¸€å®šçš„é’±æ•°Xå…ƒå»å¢åŠ æ¥å—è€…Bé’±æ•°çš„3Xå…ƒ</span>ä½œä¸ºæƒ©ç½šã€‚
                        </p>
                    </div>
                    <p class='ready'>
                        <é˜…è¯»æ˜ç™½åè¯·ç‚¹å‡»å¼€å§‹ğŸ‘‡>
                    </p>
                </div>`,
            ],
            show_clickable_nav: true,
            allow_backward: false,
            button_label_next: 'å¼€å§‹',
            allow_keys: false,
        };

        var exp2 = {
            timeline: [
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: '<p style="font-size:60px;font-weight:bolder">+</p>',
                    choices: "NO_KEYS",
                    trial_duration: 1000
                },
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: function () {
                        var html = `<div class="container text-center">
                                <div class="row g-2">
                                    <div class="col-6">
                                    <div class="p-3">åˆ†é…è€…A</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">æ¥å—è€…B</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">${jsPsych.timelineVariable('a_money')}</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">${jsPsych.timelineVariable('b_money')}</div>
                                    </div>
                                </div>
                            </div>`
                        return html
                    },
                    trial_duration: 2000,
                    data:{task:function () {
                        var html = `${jsPsych.timelineVariable('a_money')}:${jsPsych.timelineVariable('b_money')}`
                        return html
                        }
                    },
                },
                {
                    type: jsPsychHtmlButtonResponse,
                    stimulus: `<p class='h2'>æ˜¯å¦é€‰æ‹©å¢åŠ Bçš„é’±æ•°ï¼Ÿ</p>`,
                    choices: ['æ˜¯','å¦'],
                    button_html:'<button class="jspsych-btn" id="jspsych-btn-choice">%choice%</button>',
                    data:{task:'choice2'}
                },
            ],
        }

        var exp2_choice_trial = {
            timeline:[
                {
                    type: jsPsychHtmlButtonResponse,
                    stimulus: `<p class='h2'>cé€‰æ‹©æ‹¿å‡ºå¤šå°‘ï¼Ÿ</p>`,
                    choices: ['5','10','15','20','25','30','35'],
                    data:{task:'money'}
                },
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: function () {
                        var choice1 = jsPsych.data.get().last(1).values()[0].response;
                        var html = `
                        <div class='h1' style='text-align:left'>ç»“æœåé¦ˆ</div>
                            <div class="container text-center">
                                <div class="row g-3">
                                    <div class="col-4">
                                        <div class="p-3">åˆ†é…è€…A</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">æ¥å—è€…B</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">åˆ†é…è€…C</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('a_money')}</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('b_money')+3*(choice1+1)*5}</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('c_money')-(choice1+1)*5}</div>
                                    </div>
                                </div>
                            </div>`
                        return html
                    },
                    trial_duration: 1000
                }
            ]
        }

        var exp2_if = {
            timeline: [exp2_choice_trial],
            conditional_function: function(){
                var data = jsPsych.data.get().last(1).values()[0].response;
                if(data==1){
                    return false;
                } else {
                    return true;
                }
            }
        }

        var pre_main_exp2 = {
            timeline:[exp2,exp2_if],
            timeline_variables: [
                {a_money:65,b_money:35,c_money:50},
                {a_money:75,b_money:25,c_money:50},
            ],
            data:{task:'ready'}
        }

        var pre_exp2 = {
            timeline: [pre_main_exp2,ready_end],
            loop_function: function(data){
                if(jsPsych.data.get().last(1).values()[0].response==0){
                    return true;
                } else {
                    return false;
                }
            }
        }

        var main_exp2 = {
            timeline:[exp2,exp2_if],
            repetitions: 4,
            randomize_order: true,
            timeline_variables: [
                {a_money:100,b_money:0,c_money:50},
                {a_money:90,b_money:10,c_money:50},
                {a_money:80,b_money:20,c_money:50},
                {a_money:70,b_money:30,c_money:50},
                {a_money:60,b_money:40,c_money:50},
                {a_money:50,b_money:50,c_money:50},
            ],
        }

        var exp3_instr = {
            type: jsPsychInstructions,
            pages: [
                `<div class='cover'>
                    <p class='h1'>å®éªŒä¸‰</p>
                    <div class='cover-text'>
                       <p>
                            <span class='lighting'>Aå’ŒBåœ¨å…±åŒå®Œæˆä¸€é¡¹ä»»åŠ¡ã€ä»˜å‡ºåŒæ ·çš„åŠ³åŠ¨</span>åè·å¾—100å…ƒæŠ¥é…¬ï¼Œ
                            <span class='lighting'>åˆ†é…è€…Aè¿›è¡Œåˆ†é…</span>ï¼Œéœ€è¦å°†è¿™100å…ƒåˆ†é…ç»™è‡ªå·±å’Œæ¥å—è€…Bï¼Œ
                            <span class='lighting'>è€Œæ¥å—è€…Bæ— æƒæ‹’ç»</span>ï¼Œåªèƒ½æ¥å—ã€‚
                        </p>
                        <p>
                            <span class='lighting'>æ—è§‚è€…Cäº‹å…ˆæ‹¥æœ‰50å…ƒ</span>ï¼Œä¸å‚ä¸è¿™100å…ƒåˆ†é…ï¼Œ
                            ä½†æ˜¯Cå¯ä»¥åœ¨Aè¿›è¡Œåˆ†é…å<span class='lighting'>é€‰æ‹©æ˜¯å¦å¯¹åˆ†é…æ–¹æ¡ˆè¿›è¡Œè°ƒæ•´</span>ã€‚
                        </p>
                        <p>
                            è°ƒæ•´è§„åˆ™å¦‚ä¸‹ï¼šæ—è§‚è€…Cæœ‰æƒä»è‡ªå·±çš„50å…ƒé’±ä¸­
                            <span class='lighting'>æ‹¿å‡ºä¸€å®šçš„é’±æ•°Xå…ƒå»å‡å°‘Aæˆ–è€…å¢åŠ æ¥å—è€…Bé’±æ•°çš„3Xå…ƒ</span>ã€‚
                        </p>
                    </div>
                    <p class='ready'>
                        <é˜…è¯»æ˜ç™½åè¯·ç‚¹å‡»å¼€å§‹ğŸ‘‡>
                    </p>
                </div>`,
            ],
            show_clickable_nav: true,
            allow_backward: false,
            button_label_next: 'å¼€å§‹',
            allow_keys: false,
        };

        var exp3 = {
            timeline: [
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: '<p style="font-size:60px;font-weight:bolder">+</p>',
                    choices: "NO_KEYS",
                    trial_duration: 1000
                },
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: function () {
                        var html = `<div class="container text-center">
                                <div class="row g-2">
                                    <div class="col-6">
                                    <div class="p-3">åˆ†é…è€…A</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">æ¥å—è€…B</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">${jsPsych.timelineVariable('a_money')}</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">${jsPsych.timelineVariable('b_money')}</div>
                                    </div>
                                </div>
                            </div>`
                        return html
                    },
                    trial_duration: 2000,
                    data:{task:function () {
                        var html = `${jsPsych.timelineVariable('a_money')}:${jsPsych.timelineVariable('b_money')}`
                        return html
                        }
                    },
                },
                {
                    type: jsPsychHtmlButtonResponse,
                    stimulus: `<p class='h2'>ä½ çš„é€‰æ‹©æ˜¯ä¿ç•™ï¼Ÿ</p>`,
                    choices: ['å‡å°‘A','ä¿ç•™ï¼ˆä¸å‡å°‘Aä¹Ÿä¸å¢åŠ Bï¼‰','å¢åŠ B'],
                    button_html:'<button class="jspsych-btn" id="jspsych-btn-choice">%choice%</button>',
                    data:{task:'choice3'}
                },
            ],
        }

        var exp3_choice_trial = {
            timeline:[
                {
                    type: jsPsychHtmlButtonResponse,
                    stimulus: `<p class='h2'>cé€‰æ‹©æ‹¿å‡ºå¤šå°‘ï¼Ÿ</p>`,
                    choices: ['5','10','15','20','25','30','35'],
                    data:{task:'money'}
                },
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: function () {
                        var choice1 = jsPsych.data.get().last(1).values()[0].response;
                        var updown = jsPsych.data.get().last(2).values()[0].response;
                        if (updown==0){
                            var html = `
                            <div class='h1' style='text-align:left'>ç»“æœåé¦ˆ</div>
                            <div class="container text-center">
                                <div class="row g-3">
                                    <div class="col-4">
                                        <div class="p-3">åˆ†é…è€…A</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">æ¥å—è€…B</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">åˆ†é…è€…C</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('a_money')-3*(choice1+1)*5}</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('b_money')}</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('c_money')-(choice1+1)*5}</div>
                                    </div>
                                </div>
                            </div>`
                        } else {
                            var html = `
                            <div class='h1' style='text-align:left'>ç»“æœåé¦ˆ</div>
                            <div class="container text-center">
                                <div class="row g-3">
                                    <div class="col-4">
                                        <div class="p-3">åˆ†é…è€…A</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">æ¥å—è€…B</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">åˆ†é…è€…C</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('a_money')}</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('b_money')+3*(choice1+1)*5}</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="p-3">${jsPsych.timelineVariable('c_money')-(choice1+1)*5}</div>
                                    </div>
                                </div>
                            </div>`            
                        }
                        return html
                    },
                    trial_duration: 1000
                }
            ]
        }

        var exp3_if = {
            timeline: [exp3_choice_trial],
            conditional_function: function(){
                var data = jsPsych.data.get().last(1).values()[0].response;
                if(data==1){
                    return false;
                } else {
                    return true;
                }
            }
        }

        var pre_main_exp3 = {
            timeline:[exp3,exp3_if],
            timeline_variables: [
                {a_money:65,b_money:35,c_money:50},
                {a_money:75,b_money:25,c_money:50},
            ],
            data:{task:'ready'}
        }

        var pre_exp3 = {
            timeline: [pre_main_exp3,ready_end],
            loop_function: function(data){
                if(jsPsych.data.get().last(1).values()[0].response==0){
                    return true;
                } else {
                    return false;
                }
            }
        }

        var main_exp3 = {
            timeline:[exp3,exp3_if],
            repetitions: 4,
            randomize_order: true,
            timeline_variables: [
                {a_money:100,b_money:0,c_money:50},
                {a_money:90,b_money:10,c_money:50},
                {a_money:80,b_money:20,c_money:50},
                {a_money:70,b_money:30,c_money:50},
                {a_money:60,b_money:40,c_money:50},
                {a_money:50,b_money:50,c_money:50},
            ],
        }

        var exp4_instr = {
            type: jsPsychInstructions,
            pages: [
                `<div class='cover'>
                    <p class='h1'>å®éªŒå››</p>
                    <div class='cover-text'>
                       <p>
                            <span class='lighting'>Aå’ŒBåœ¨å…±åŒå®Œæˆä¸€é¡¹ä»»åŠ¡ã€ä»˜å‡ºåŒæ ·çš„åŠ³åŠ¨</span>åè·å¾—100å…ƒæŠ¥é…¬ï¼Œ
                            <span class='lighting'>åˆ†é…è€…Aè¿›è¡Œåˆ†é…</span>ï¼Œéœ€è¦å°†è¿™100å…ƒåˆ†é…ç»™è‡ªå·±å’Œæ¥å—è€…Bï¼Œ
                            <span class='lighting'>è€Œæ¥å—è€…Bæ— æƒæ‹’ç»</span>ï¼Œåªèƒ½æ¥å—ã€‚
                        </p>
                        <p>
                            <span class='lighting'>æ—è§‚è€…Cäº‹å…ˆæ‹¥æœ‰50å…ƒ</span>ï¼Œä¸å‚ä¸è¿™100å…ƒåˆ†é…ï¼Œ
                            ä½†æ˜¯Cå¯ä»¥åœ¨Aè¿›è¡Œåˆ†é…å<span class='lighting'>é€‰æ‹©æ˜¯å¦å¯¹åˆ†é…æ–¹æ¡ˆè¿›è¡Œè°ƒæ•´</span>ã€‚
                        </p>
                        <p>
                            è°ƒæ•´è§„åˆ™å¦‚ä¸‹ï¼šæ—è§‚è€…Cæœ‰æƒä»è‡ªå·±çš„50å…ƒé’±ä¸­
                            <span class='lighting'>æ‹¿å‡ºä¸€å®šçš„é’±æ•°Xå…ƒå»å‡å°‘Aé’±æ•°çš„3Xå…ƒå¹¶ä¸”æ‹¿å‡ºä¸€å®šçš„é’±æ•°Yå…ƒå¢åŠ æ¥å—è€…Bé’±æ•°çš„3Yå…ƒ</span>ã€‚
                        </p>
                    </div>
                    <p class='ready'>
                        <é˜…è¯»æ˜ç™½åè¯·ç‚¹å‡»å¼€å§‹ğŸ‘‡>
                    </p>
                </div>`,
            ],
            show_clickable_nav: true,
            allow_backward: false,
            button_label_next: 'å¼€å§‹',
            allow_keys: false,
        };

        var exp4 = {
            timeline: [
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: '<p style="font-size:60px;font-weight:bolder">+</p>',
                    choices: "NO_KEYS",
                    trial_duration: 1000
                },
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: function () {
                        var html = `<div class="container text-center">
                                <div class="row g-2">
                                    <div class="col-6">
                                    <div class="p-3">åˆ†é…è€…A</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">æ¥å—è€…B</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">${jsPsych.timelineVariable('a_money')}</div>
                                    </div>
                                    <div class="col-6">
                                    <div class="p-3">${jsPsych.timelineVariable('b_money')}</div>
                                    </div>
                                </div>
                            </div>`
                        return html
                    },
                    trial_duration: 2000,
                    data:{task:function () {
                        var html = `${jsPsych.timelineVariable('a_money')}:${jsPsych.timelineVariable('b_money')}`
                        return html
                        }
                    },
                },
                {
                    type: jsPsychHtmlButtonResponse,
                    stimulus: `<p class='h2'>æ˜¯å¦é€‰æ‹©æ”¹å˜åˆ†é…æ–¹æ¡ˆ</p>`,
                    choices: ['æ”¹å˜','ä¸æ”¹å˜'],
                    button_html:'<button class="jspsych-btn" id="jspsych-btn-choice">%choice%</button>',
                    data:{task:'choice4'}
                },
            ],
        }

        var exp4_choice_trial = {
            timeline:[
                {
                    type: jsPsychSurveyHtmlForm,
                    preamble: "",
                    html: ` 
                            <div class='h2'>Cä»˜å‡ºé‡‘é¢(æ€»é‡‘é¢ä¸º50å…ƒ)</div>
                            <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                                <span class="input-group-text" style='font-size:20px' >å‡å°‘A</span>
                                <input type="radio" class="btn-check" name="down_a" id="down_a1" value="0" required>
                                <label class="btn btn-light btn-lg" for="down_a1">0</label>

                                <input type="radio" class="btn-check" name="down_a" id="down_a2" value="5">
                                <label class="btn btn-light btn-lg" for="down_a2">5</label>

                                <input type="radio" class="btn-check" name="down_a" id="down_a3" value="10">
                                <label class="btn btn-light btn-lg" for="down_a3">10</label>

                                <input type="radio" class="btn-check" name="down_a" id="down_a4" value="15">
                                <label class="btn btn-light btn-lg" for="down_a4">15</label>

                                <input type="radio" class="btn-check" name="down_a" id="down_a5" value="20">
                                <label class="btn btn-light btn-lg" for="down_a5">20</label>

                                <input type="radio" class="btn-check" name="down_a" id="down_a6" value="25">
                                <label class="btn btn-light btn-lg" for="down_a6">25</label>

                                <input type="radio" class="btn-check" name="down_a" id="down_a7" value="30">
                                <label class="btn btn-light btn-lg" for="down_a7">30</label>
                                
                                <input type="radio" class="btn-check" name="down_a" id="down_a8" value="35">
                                <label class="btn btn-light btn-lg" for="down_a8">35</label>
                            </div>

                            <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                                <span class="input-group-text" style='font-size:20px'>å¢åŠ B</span>
                                <input type="radio" class="btn-check" name="up_b" id="up_b1" value="0" required>
                                <label class="btn btn-light btn-lg" for="up_b1">0</label>

                                <input type="radio" class="btn-check" name="up_b" id="up_b2" value="5">
                                <label class="btn btn-light btn-lg" for="up_b2">5</label>

                                <input type="radio" class="btn-check" name="up_b" id="up_b3" value="10">
                                <label class="btn btn-light btn-lg" for="up_b3">10</label>

                                <input type="radio" class="btn-check" name="up_b" id="up_b4" value="15">
                                <label class="btn btn-light btn-lg" for="up_b4">15</label>

                                <input type="radio" class="btn-check" name="up_b" id="up_b5" value="20">
                                <label class="btn btn-light btn-lg" for="up_b5">20</label>

                                <input type="radio" class="btn-check" name="up_b" id="up_b6" value="25">
                                <label class="btn btn-light btn-lg" for="up_b6">25</label>

                                <input type="radio" class="btn-check" name="up_b" id="up_b7" value="30">
                                <label class="btn btn-light btn-lg" for="up_b7">30</label>
                                
                                <input type="radio" class="btn-check" name="up_b" id="up_b8" value="35">
                                <label class="btn btn-light btn-lg" for="up_b8">35</label>
                            </div>`,
                    button_label: 'æäº¤',
                    dataAsArray: true,
                    autofocus: 'test-resp-box',
                    data:{task:'money'},
                },
                {
                    type: jsPsychHtmlKeyboardResponse,
                    stimulus: function () {
                        var downa = jsPsych.data.get().last(1).values()[0].response[0].value;
                        var upb = jsPsych.data.get().last(1).values()[0].response[1].value
                        var html = `
                        <div class='h1' style='text-align:left'>ç»“æœåé¦ˆ</div>
                        <div class="container text-center">
                            <div class="row g-3">
                                <div class="col-4">
                                    <div class="p-3">åˆ†é…è€…A</div>
                                </div>
                                <div class="col-4">
                                    <div class="p-3">æ¥å—è€…B</div>
                                </div>
                                <div class="col-4">
                                    <div class="p-3">åˆ†é…è€…C</div>
                                </div>
                                <div class="col-4">
                                    <div class="p-3">${jsPsych.timelineVariable('a_money')-3*downa}</div>
                                </div>
                                <div class="col-4">
                                    <div class="p-3">${jsPsych.timelineVariable('b_money')+3*upb}</div>
                                </div>
                                <div class="col-4">
                                    <div class="p-3">${jsPsych.timelineVariable('c_money')-downa-upb}</div>
                                </div>
                            </div>
                        </div>`
                        return html
                    },
                    trial_duration: 1000
                }
            ]
        }

        var exp4_if = {
            timeline: [exp4_choice_trial],
            conditional_function: function(){
                var data = jsPsych.data.get().last(1).values()[0].response;
                if(data==1){
                    return false;
                } else {
                    return true;
                }
            }
        }

        var pre_main_exp4 = {
            timeline:[exp4,exp4_if],
            timeline_variables: [
                {a_money:65,b_money:35,c_money:50},
                {a_money:75,b_money:25,c_money:50},
            ],
            data:{task:'ready'}
        }

        var pre_exp4 = {
            timeline: [pre_main_exp4,ready_end],
            loop_function: function(data){
                if(jsPsych.data.get().last(1).values()[0].response==0){
                    return true;
                } else {
                    return false;
                }
            }
        }

        var main_exp4 = {
            timeline:[exp4,exp4_if],
            repetitions: 4,
            randomize_order: true,
            timeline_variables: [
                {a_money:100,b_money:0,c_money:50},
                {a_money:90,b_money:10,c_money:50},
                {a_money:80,b_money:20,c_money:50},
                {a_money:70,b_money:30,c_money:50},
                {a_money:60,b_money:40,c_money:50},
                {a_money:50,b_money:50,c_money:50},
            ],
        }

        function html_scale(scale_list) {
            var scale_html = `<div class='instruction'>${scale_list[0]}</div>
                                <div class='row'>`
            for (var l = 1;l< scale_list.length-1;l++){
                scale_html += `<label class="form-label">${scale_list[l]}</label>
                                    <div class="btn-group">`

                var options = scale_list[scale_list.length - 1];

                for (var i = 0; i < options.length; i++) {
                    scale_html += `
                        <input type="radio" class="btn-check" name="scale_${l}" id="scale_${l}${i+1}" value="${i+1}" required>
                        <label class="btn btn-light btn-lg" for="scale_${l}${i+1}">${options[i]}</label>
                    `;}
                scale_html += '</div>';
            }
            scale_html += '</div>'
            return scale_html
        };

        fair_list = [
            'ä½ è§‰å¾—ä»¥ä¸‹çš„åˆ†é…æ–¹æ¡ˆæ˜¯å¦å…¬å¹³ï¼Ÿ',
            '50ï¼š50',
            '60ï¼š40',
            '70ï¼š30',
            '80ï¼š20',
            '90ï¼š10',
            '100ï¼š0',
            ['éå¸¸ä¸å…¬å¹³','ä¸å…¬å¹³','æ¯”è¾ƒä¸å…¬å¹³','æœ‰ç‚¹ä¸å…¬å¹³','æœ‰ç‚¹å…¬å¹³','æ¯”è¾ƒå…¬å¹³','å…¬å¹³','éå¸¸å…¬å¹³']
        ]
        
        var fair_scale = {
            type: jsPsychSurveyHtmlForm,    
            preamble: '',
            html: html_scale(fair_list),
            button_label: 'æäº¤',
            autofocus: 'test-resp-box',
            data:{task:'fair'}
        }

        var end = {
            type: jsPsychHtmlKeyboardResponse,
            stimulus:`<h1 style='line-height:2.7rem'>å®éªŒç»“æŸï¼Œæ„Ÿè°¢æ‚¨çš„å‚ä¸ï¼<br/>ç¥æ‚¨æœ‰ä¸ªç¾å¥½çš„ä¸€å¤©ğŸŒï¼</h1>`,
            trial_duration: 3000,
            choices: "NO_KEYS",
        }

        var exit_fullscreen = {
            type: jsPsychFullscreen,
            fullscreen_mode: false,
            delay_after: 0,
        }


        timeline = [
            enter_fullscreen,
            set_style,
            info,
            agreement,
            actor,
            exp1_instr,
            ready,
            pre_exp1,
            main_exp1,
            exp2_instr,
            ready,
            pre_exp2,
            main_exp2,
            exp3_instr,
            ready,
            pre_exp3,
            main_exp3,
            exp4_instr,
            ready,
            pre_exp4,
            main_exp4,
            fair_scale,
            end,
            exit_fullscreen
        ]

        // jsPsych.simulate(timeline, "visual");
        jsPsych.run(timeline)
    </script>
</html>